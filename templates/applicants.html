{% extends "base.html" %}
{% block title %}Applicants for {{ job.title }}{% endblock %}
{% block content %}
<h2>Applicants for "{{ job.title }}"</h2>
<table>
    <tr>
        <th>Email</th>
        <th>Tech Score</th>
        <th>Comm Score</th>
        <th>Status</th>
        <th>Actions</th>
    </tr>
    {% for c in candidates %}
    <tr>
        <td>{{ c.email }}</td>
        <td>{{ c.tech_score }}</td>
        <td>{{ c.comm_score }}</td>
        <td class="status" data-s="{{ c.status }}">{{ c.status }}</td>
        <td>
            <div style="display:flex; gap:8px; align-items:center; flex-wrap:wrap;">
                <a class="btn secondary" href="{{ url_for('feedback_view', job_id=job.id) }}">View Feedback</a>
                <a class="btn" href="http://127.0.0.1:8000/interview?app_id={{ c.application_id }}&candidate_email={{ c.email|urlencode }}&job_title={{ job.title|urlencode }}" target="_blank" rel="noopener noreferrer">Start Interview</a>
                <!--<a class="btn" href="http://localhost:5001/start?app_id={{ c.application_id }}&candidate_email={{ c.email }}&job_title={{ job.title }}" target="_blank" rel="noopener noreferrer">Start Interview</a> -->
                <form method="post" action="{{ url_for('add_review', app_id=c.application_id) }}" style="display:flex; gap:6px; align-items:center;">
                    <input type="hidden" name="job_id" value="{{ job.id }}">
                    <label class="sr-only" for="type-{{ c.application_id }}">Reviewer</label>
                    <select id="type-{{ c.application_id }}" name="reviewer_type">
                        <option value="tech">Tech</option>
                        <option value="hr">HR</option>
                    </select>
                    <label class="sr-only" for="score-{{ c.application_id }}">Score</label>
                    <input id="score-{{ c.application_id }}" type="number" name="score" min="0" max="100" placeholder="Score" required>
                    <label class="sr-only" for="comment-{{ c.application_id }}">Comment</label>
                    <input id="comment-{{ c.application_id }}" type="text" name="comment" placeholder="Comment" required>
                    <button class="btn success" type="submit">Add Review</button>
                </form>
            </div>
        </td>
    </tr>
    {% endfor %}
</table>
{% endblock %}